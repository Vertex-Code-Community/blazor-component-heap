@using Bch.Components.Modal

<div class="bch-datepicker-wrapper @CssClass" id="@_containerId" tabindex="-1">

    <div class="bch-datepicker" @onclick="OnCalendarClickedAsync">
        <input id="@_inputId"
               class="bch-datepicker-input"
               readonly
               autocomplete="unrechable-filter-to-autocomplete"
               value="@_value.ToString(Format)"
               @ref="@_inputRef"/>
        <img class="bch-datepicker-img" src="_content/BlazorComponentHeap.Core/bch-img/datepicker/calendar-icon.svg"/>
    </div>

    <BchModal CssClass="@($"bch-calendar-days-modal-wrapper {CssClass}")"
              Width="250px"
              Height="unset"
              X="@($"{_containerPos.X.ToString(_nF)}px")"
              Y="@($"{_containerPos.Y.ToString(_nF)}px")"
              Show="_showDate"
              ShowChanged="OnDateChanged">
        <BCHCalendarDays Id="@_calendarDaysId"
                         OnDateSelected=" e => { Value = e; _showDate = false; return OnShowModeChangedAsync(); }"
                         Culture="@Culture"
                         DefaultMonth="_selectedMonth"
                         DefaultYear="_selectedYear"
                         OnFocusOut="() => _inputRef.FocusAsync()"
                         SelectedDate="Value"
                         IsShowMonth="e => { _showMonth = e; _showDate = false; return OnShowModeChangedAsync(); }"/>
    </BchModal>

    <BchModal CssClass="@($"bch-calendar-months-modal-wrapper {CssClass}")"
              Width="250px"
              Height="unset"
              X="@($"{_containerPos.X.ToString(_nF)}px")"
              Y="@($"{_containerPos.Y.ToString(_nF)}px")"
              Show="_showMonth"
              ShowChanged="OnMonthChanged">
        <BCHCalendarMonths Id="@_calendarMonthsId"
                           YearsSelectContentId="@_yearsSelectContentId"
                           SelectedMonth="_selectedMonth"
                           SelectedYear="_selectedYear"
                           MonthChanged="e => { _selectedMonth = e; return OnShowModeChangedAsync(); }"
                           YearChanged="e => { _selectedYear = e; return OnShowModeChangedAsync(); }"
                           IsShowDate="e => { _showMonth = false; _showDate = e; return OnShowModeChangedAsync(); }"
                           OnFocusOut="() => _inputRef.FocusAsync()"/>
    </BchModal>
</div>

<style>
    .bch-calendar-days-modal-wrapper,
    .bch-calendar-months-modal-wrapper {
        transform: translateY(49px);
    }
</style>